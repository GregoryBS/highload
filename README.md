# Проектирование веб-сервиса
Автор: Будкин Григорий<br>
Преподаватели: Бодин Антон, Быков Александр

## Содержание
1. [Тема и целевая аудитория](#introduction)
2. [Расчёт нагрузки](#load-calculation)
    1. [Продуктовые метрики](#product-metrics)
    2. [Технические метрики](#tech-metrics)
3. [Список литературы](#literature)


## Тема и целевая аудитория <a name="introduction"></a>
В качестве темы выбран сервис Dropbox -  файловый хостинг компании Dropbox Inc., включающий персональное облачное хранилище, синхронизацию файлов и программу-клиент.<br>
Для реализации MVP предлагается следующий функционал: 
* Загрузка файлов любого формата в персональное хранилище
* Скачивание файлов из хранилища
* Просмотр загруженных файлов через веб-интерфейс
* Предоставление доступа на просмотр файлов третьим лицам

Для рассмотрения целевой аудитории в качестве основы будут взяты данные о сервисе Dropbox. Согласно источнику [1], общее количество зарегистрированных пользователей сервиса во всём мире превышает число в 700 миллионов. При этом:
* более 75% пользователей - вне США;
* следовательно в США находится около 25% пользователей, т.е. 700 * 10^6 * 0.25 = 175 * 10^6 = 175 миллионов;
* в Японии более 10 миллионов пользователей.

## Расчёт нагрузки <a name="load-calculation"></a>
В данном разделе будут приведены основные продуктовые и технические метрики, необходимые для расчёта общей нагрузки на сервис.

### Продуктовые метрики <a name="product-metrics"></a>
Dropbox не раскрывает количество активных пользователей, однако согласно анализу в месяц совершается около 172 миллионов посещений [2]. В среднем ежедневно около 6 миллионов посещений. Пусть 50% из них происходит с запросом авторизации, тогда ежедневно выполняется 3 миллиона запросов на авторизацию.<br>
Размер хранилища, доступный при бесплатном использовании, равен 2 Гб. Удвоим размер хранилища для обеспечения нужд новых и платных пользователей: 700 * 10^6 * 2 * 2 = 2800 * 10^6 Гб ~ 2.73 * 10^6 Тб.<br>
*Таблица 1. Среднее количество действий пользователей [1].*
| Тип запроса | Среднее количество (млн/день) |
| --- | ----------- |
| Загрузка файлов | 345 |
| Просмотр файлов | 1200 |
| Предоставление доступа к файлу | 2.4 |
| Авторизация | 3 |
| Просмотр списка файлов | 6 |

### Технические метрики <a name="tech-metrics"></a>
Так как размер пользовательских данных достаточно мал относительно размера файловых хранилищ, то будем считать, что достаточно 2.75 * 10^6 Тб памяти.<br>
Обычно пользовательские файлы представляют собой изображения и текстовые документы. Будем считать, что их средний размер - 2Мб. Исходя из данных в таблице 1 рассчитаем объём входящего и исходящего трафика и RPS, учитывая, что в пике средняя нагрузка увеличена в 2 раза.<br>
*Таблица 2. Входящий трафик.*
|Тип запроса|Объём 1 запроса (Кб)|Суточный объём (Гб/сутки)| Суточный объём в пике |
| --- | ----------- | --- | --- |
|Авторизация|1|2.86|560 Кбит/с|
|Предоставление доступа к файлу|1|2.29|448 Кбит/с|
|Загрузка файлов|2048|673828|124.8 Гбит/с|

*Таблица 3. Исходящий трафик.*
|Тип запроса|Объём 1 запроса (Кб)|Суточный объём (Гб/сутки)| Суточный объём в пике |
| --- | ----------- | --- | --- |
|Просмотр списка файлов|512|2929.7|0.54 Гбит/с|
|Просмотр файлов|2048|2343749.6|434 Гбит/с|

*Таблица 4. Количество RPS по типам запросов.*
| Тип запроса | RPS |
| --- | ----------- |
| Загрузка файлов | 8000 |
| Просмотр файлов | 28000 |
| Предоставление доступа к файлу | 56 |
| Авторизация | 70 |
| Просмотр списка файлов | 140 |

## Список литературы <a name="literature"></a>
1. https://expandedramblings.com/index.php/dropbox-statistics/
2. https://www.similarweb.com/ru/website/dropbox.com/#overview
3. https://medium.com/codex/design-dropbox-e82b61e5b197
